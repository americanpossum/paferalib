items1=[];items2=[];function ListApps(){P.DialogAPI("translations/listapps",{langcode:$$(".langcode1").value},function(g){var e=$(".appnames");$("option",e).remove();if(g.count){var b=[];var c=g.items.sort();for(var f=0,a=c.length;f<a;f++){b.push("<option>"+EncodeEntities(c[f])+"</option>")}e.ht(b.join("\n"));$(".ListResults").fill("")}})}function ListCollections(){P.DialogAPI("translations/listcollections",{appname:$$(".appnames").value,langcode:$$(".langcode1").value},function(g){var f=$(".collections");$("option",f).remove();if(g.count){var b=[];var c=g.items.sort();for(var e=0,a=c.length;e<a;e++){b.push("<option>"+EncodeEntities(c[e])+"</option>")}f.ht(b.join("\n"));$(".ListResults").fill("")}})}function ListObjects(){var b=$$(".langcode1").value;var a=$$(".langcode2").value;var c=$$(".appnames").value+"/"+$$(".collections").value;if(b==a){$(".ListResults").ht("<div class=Error>Your two langcodes are the same.</div>");return}P.DialogAPI("translations/translations",{langcode1:b,langcode2:a,collection:c},function(e){items1=e.items[b];items2=e.items[a];MakeTranslationsTable()})}function MakeTranslationsTable(){var c=$$(".langcode1").value;var b=$$(".langcode2").value;var a=['<table class="Styled Width100 Translations">',"<thead>","<tr>","<th>ID</th>","<th>"+P.Selected(".langcode1").text+"</th>","<th>"+P.Selected(".langcode2").text+"</th>","</tr>","</thead>","<tbody class=ObjectsBody>"];for(var d=1;d<9999;d++){var g=items1[d];var e=items2[d];if(!g){g=""}if(!e){e=""}switch(P.screensize){case"small":var f=14;break;case"medium":var f=26;break;default:var f=80}g=g.length>f?g.substr(0,f)+"...":g;e=e.length>f?e.substr(0,f)+"...":e;a=a.concat(["<tr>","<td class=TextID>"+d+"</td>","<td class=Hover data-textid="+d+' data-lang="'+c+'">'+EncodeEntities(g)+"</td>","<td class=Hover data-textid="+d+' data-lang="'+b+'">'+EncodeEntities(e)+"</td>","</tr>"]);if(!g&&!e){break}}a.addtext(["</tbody>","</table>","<div class=ButtonBar>",'<a class="RenameCollectionButton Color1" onclick="RenameCollectionPopup()">Rename Collection</a>','<a class="DeleteCollectionButton Color2" onclick="DeleteCollectionPopup()">Delete Collection</a>',"</div>","<div class=Cleared></div>"]);$(".ListResults").ht(a.join("\n"));$(".Translations").on("click",OnTranslationClicked,"td");$(".RenameCollectionButton").on("click",function(){RenameCollectionPopup(1)});$(".DeleteCollectionButton").on("click",function(){var h=$$(".appnames").value+"/"+$$(".collections").value;P.ConfirmDeletePopup(h,function(){P.LoadingAPI(".ConfirmDeleteResults","translations/delete",{collection:h},function(i){$(".ConfirmDeletePopup").remove()})})})}function OnTranslationClicked(d){var c=P.Target(d);var b=c.get("%textid");if(!b){return}b=parseInt(b);var h=c.get("%lang");var g=(h==$$(".langcode1").value)?items1[b]:items2[b];var a=$$(".appnames").value;var f=$$(".collections").value;$(".FullScreen").set("+dblueg").show().ht(['<div class="Padded FullWidth">','<div class=FlexInput data-name=TranslationText data-value="'+EncodeEntities(g)+'"></div>',"<div class=ButtonBar>",'<a class="Color3" onclick="SaveTranslation(\''+h+"', "+b+')">Save</a>','<a class="Spacer Width8"></a>','<a class="Color1" onclick="$(\'.FullScreen\').hide()">Cancel</a>',"</div>","<div class=SaveResults></div>","</div>"].join("\n"));P.FlexInput();setTimeout(function(){$$(".TranslationText").select()},200)}function SaveTranslation(f,d){d=parseInt(d);var a=$$(".appnames").value;var e=$$(".collections").value;var g=$$(".TranslationText").value;if((f==$$(".langcode1").value)){items1[d]=g}else{items2[d]=g}var c=0;$("td").each(function(i){var h=$(i);var j=parseInt(h.get("%textid"));if(j==d&&h.get("%lang")==f){h.fill(g);$$(h).scrollIntoView()}if(j>c){c=j}});if(d==c){var b=d+1;$$(".ObjectsBody").innerHTML+=["<tr>","<td class=TextID>"+b+"</td>","<td class=Hover data-textid="+b+" data-lang="+$$(".langcode1").value+"></td>","<td class=Hover data-textid="+b+" data-lang="+$$(".langcode2").value+"></td>","</tr>"].join("\n")}P.LoadingAPI(".SaveResults","translations/saveone",{collection:a+"/"+e,textid:d,translation:g,langcode:f},function(){$(".FullScreen").set("-dblueg").hide()})}function RenameCollectionPopup(a){var c=a?$$(".appnames").value+"/"+$$(".collections").value:"";var b=0;b=P.EditPopup([["newvalue","multitext",c,"New name"]],function(g){var e=$$(".newvalue").value;var f=e.split("/");if(f.length==1){f[0]=$$(".appnames").value;e=f[0]+"/"+e}P.LoadingAPI(".EditPopupResults","translations/"+(a?"rename":"create"),{collection:c,newname:e},function(h){P.CloseThisPopup(".EditPopupResults");ListCollections();$$(".appnames").value=f[0];setTimeout(ListTranslations,300)})},{parent:a?$(".RenameCollectionButton"):$(".NewCollectionButton"),cancelfunc:function(e){$(e).remove()}})}function DeleteCollectionPopup(){P.DialogAPI("translations/delete",{collection:$$(".appnames").value+"/"+$$(".collections").value},function(a){})}function DeleteCollection(){P.DialogAPI("translations/delete",{collection:$$(".appnames").value+"/"+$$(".collections").value},function(a){})}function CheckSamelangcode(h){var e=$(".langcode1");var d=$(".langcode2");var a=e[0].value;var j=d[0].value;if(a!=j){return}if(h==1){var g=a;var f=d}else{var g=j;var f=e}var k=f[0].options;var b=k.length;for(var c=0;c<k.length;c++){if(k[c].value!=g){f.value=k[c].value;break}}}$(".ListTranslationsButton").on("click",ListObjects);$(".RefreshAppsButton").on("click",ListApps);$(".RefreshCollectionsButton").on("click",ListCollections);$(".NewCollectionButton").on("click",function(){RenameCollectionPopup()});$(".appnames").on("change",ListCollections);$(".collections").on("change",ListObjects);$(".langcode1").on("change",function(){CheckSamelangcode(1)});$(".langcode2").on("change",function(){CheckSamelangcode(2)});